
-- First create the clients that don't exist
INSERT INTO public.crm_clients (name, status, pipeline_stage) VALUES
  ('ACCESFLUID', 'activo', 'cerrado_ganado'),
  ('P. OLAMENDI - P. BARRIA', 'activo', 'cerrado_ganado'),
  ('ABRIL ET NATURE', 'activo', 'cerrado_ganado'),
  ('ANGEL RODRIGUEZ E HIJOS', 'activo', 'cerrado_ganado'),
  ('ARMAKIT, S.L.', 'activo', 'cerrado_ganado'),
  ('ASPEM TEC, S.L. - ANCA INVEST', 'activo', 'cerrado_ganado'),
  ('ARS PIROTECNIA, S.L.', 'activo', 'cerrado_ganado'),
  ('AKILES TECNOLOGIES', 'activo', 'cerrado_ganado'),
  ('AUMAR TRANS, S.L.', 'activo', 'cerrado_ganado'),
  ('BARCELONA TECHNICAL CONSOLIDAT', 'activo', 'cerrado_ganado'),
  ('BARNAGLASS', 'activo', 'cerrado_ganado'),
  ('BIGAS GRUP', 'activo', 'cerrado_ganado'),
  ('BIGAS GRUP HELICOPTERS', 'activo', 'cerrado_ganado'),
  ('BONET ESP. HIDROQUÍMIQUES', 'activo', 'cerrado_ganado'),
  ('CASA NUALART', 'activo', 'cerrado_ganado'),
  ('CEMAV, S.L.', 'activo', 'cerrado_ganado'),
  ('CNG', 'activo', 'cerrado_ganado'),
  ('COCEDERO DE MARISCOS', 'activo', 'cerrado_ganado'),
  ('CONSOLIDAT TASMANIA', 'activo', 'cerrado_ganado'),
  ('COSMEPRINT', 'activo', 'cerrado_ganado'),
  ('COMPRUM', 'activo', 'cerrado_ganado'),
  ('CUINA SOLUCIO', 'activo', 'cerrado_ganado'),
  ('DRACENA HOMES', 'activo', 'cerrado_ganado'),
  ('FEIMAT', 'activo', 'cerrado_ganado'),
  ('DIESEL CERTIFICACION', 'activo', 'cerrado_ganado'),
  ('ENUR COURRIER, S.L.', 'activo', 'cerrado_ganado'),
  ('EQUIPOS INBEAT - IND. BETA ATON', 'activo', 'cerrado_ganado'),
  ('EXCAVACIONS I TRANSPORTS SEGU', 'activo', 'cerrado_ganado'),
  ('EXARISER, S.L.', 'activo', 'cerrado_ganado'),
  ('FECOSAUTO', 'activo', 'cerrado_ganado'),
  ('FERG, S.L.', 'activo', 'cerrado_ganado'),
  ('FERROS CRISTOBAL, S.A.', 'activo', 'cerrado_ganado'),
  ('FORMIGONS TENES, S.L.', 'activo', 'cerrado_ganado'),
  ('FREMATICA ESPAÑA, S.A.', 'activo', 'cerrado_ganado'),
  ('FROM EMBALATGES', 'activo', 'cerrado_ganado'),
  ('FUNDACIO JUBANTEY - EINA - ASTEROIDE', 'activo', 'cerrado_ganado'),
  ('FUNDACIO GIRONA', 'activo', 'cerrado_ganado'),
  ('GANADERIA LES VALLS', 'activo', 'cerrado_ganado'),
  ('GARRIGA OBRES I SERVEIS', 'activo', 'cerrado_ganado'),
  ('GAYNER, S.A.', 'activo', 'cerrado_ganado'),
  ('GECOM ESPACIOS COMUNICACIÓN, S.L.', 'activo', 'cerrado_ganado'),
  ('GESAB', 'activo', 'cerrado_ganado'),
  ('GES TORELLO', 'activo', 'cerrado_ganado'),
  ('GERMANS HOM, S.L.', 'activo', 'cerrado_ganado'),
  ('GRUP FONTCUBERTA', 'activo', 'cerrado_ganado'),
  ('GRUPOPTIMA', 'activo', 'cerrado_ganado'),
  ('DES. EMP. TASMANIA', 'activo', 'cerrado_ganado'),
  ('GRUPO T2 BUROS - EJASA', 'activo', 'cerrado_ganado'),
  ('IBERLEMO, S.A.U', 'activo', 'cerrado_ganado'),
  ('IBERPUERTAS', 'activo', 'cerrado_ganado'),
  ('INDUSTRIAL DE CELOSIAS, S.A.', 'activo', 'cerrado_ganado'),
  ('INSTALUX', 'activo', 'cerrado_ganado'),
  ('JDA EXPERT LEGAL TAX', 'activo', 'cerrado_ganado'),
  ('LATAKIA INVESTMENT, S.L.', 'activo', 'cerrado_ganado'),
  ('LABORATORIOS KIN', 'activo', 'cerrado_ganado'),
  ('NIPA TRADING IMPORT-EXPORT', 'activo', 'cerrado_ganado'),
  ('LOLA CASADEMUNT', 'activo', 'cerrado_ganado'),
  ('LOLA CONSOLIDAT (ESGA DESING)', 'activo', 'cerrado_ganado'),
  ('MAC - SER - BCN 2024', 'activo', 'cerrado_ganado'),
  ('METODOLOGIA DEL TRABAJO', 'activo', 'cerrado_ganado'),
  ('MERCAPORTA', 'activo', 'cerrado_ganado'),
  ('NIGHTEVOLUTION, S.L. (AMNESIA)', 'activo', 'cerrado_ganado'),
  ('OPENERS & CLOSERS', 'activo', 'cerrado_ganado'),
  ('PAVIMENTOS PAVIRAT', 'activo', 'cerrado_ganado'),
  ('PLASTICBAND', 'activo', 'cerrado_ganado'),
  ('PROMOTORA BELLVEI', 'activo', 'cerrado_ganado'),
  ('PFP TERMOPOLÍMEROS, S.L.', 'activo', 'cerrado_ganado'),
  ('RAMADERIA PAYETAS', 'activo', 'cerrado_ganado'),
  ('REUGLAS', 'activo', 'cerrado_ganado'),
  ('RAMCON EMPRESA DE SERVICIOS', 'activo', 'cerrado_ganado'),
  ('RIGEL OVER, S.L.', 'activo', 'cerrado_ganado'),
  ('SAMACE, S.L.', 'activo', 'cerrado_ganado'),
  ('SEMIKRON, S.L.', 'activo', 'cerrado_ganado'),
  ('SERVITRANSFER', 'activo', 'cerrado_ganado'),
  ('SPC JEVSA, S.L.', 'activo', 'cerrado_ganado'),
  ('SYMYB', 'activo', 'cerrado_ganado'),
  ('TECNICAL VALLES', 'activo', 'cerrado_ganado'),
  ('TECNOGLOBAL, S.L.', 'activo', 'cerrado_ganado'),
  ('TAGOIN', 'activo', 'cerrado_ganado'),
  ('URBIOTICA, S.L.', 'activo', 'cerrado_ganado'),
  ('VALORITZACIONS VILAR GUILLEN', 'activo', 'cerrado_ganado'),
  ('VECMEDICAL, S.L.', 'activo', 'cerrado_ganado'),
  ('FACTURACIO CLIENTS JAUME', 'activo', 'cerrado_ganado'),
  ('MAÑOSA, S.L.', 'activo', 'cerrado_ganado'),
  ('ALTRES FEINES', 'activo', 'cerrado_ganado')
ON CONFLICT DO NOTHING;

-- Now insert invoices using subqueries for client_id
INSERT INTO public.crm_invoices (client_id, invoice_number, issue_date, amount, tax_amount, total_amount, status, service_description, service_type) VALUES
  ((SELECT id FROM crm_clients WHERE name='ALTRES FEINES' LIMIT 1), 'FAC-2025-001', '2025-06-30', 241238.36, 0, 241238.36, 'pagada', 'Trabajos colaboradores varios 2025', 'Auditoría de Cuentas Anuales'),
  ((SELECT id FROM crm_clients WHERE name='ACCESFLUID' LIMIT 1), 'FAC-2025-002', '2025-03-15', 6020.89, 0, 6020.89, 'pagada', 'Auditoría Cuentas Anuales 2024', 'Auditoría de Cuentas Anuales'),
  ((SELECT id FROM crm_clients WHERE name='P. OLAMENDI - P. BARRIA' LIMIT 1), 'FAC-2025-003', '2025-03-15', 6000, 0, 6000, 'pagada', 'Auditoría Cuentas Anuales 2024', 'Auditoría de Cuentas Anuales'),
  ((SELECT id FROM crm_clients WHERE name='ABRIL ET NATURE' LIMIT 1), 'FAC-2025-004', '2025-03-15', 6607.80, 0, 6607.80, 'pagada', 'Auditoría Cuentas Anuales 2024', 'Auditoría de Cuentas Anuales'),
  ((SELECT id FROM crm_clients WHERE name='ANGEL RODRIGUEZ E HIJOS' LIMIT 1), 'FAC-2025-005', '2025-03-15', 8000, 0, 8000, 'pagada', 'Auditoría Cuentas Anuales 2024', 'Auditoría de Cuentas Anuales'),
  ((SELECT id FROM crm_clients WHERE name='ARMAKIT, S.L.' LIMIT 1), 'FAC-2025-006', '2025-04-15', 8590, 0, 8590, 'pagada', 'Auditoría Cuentas Anuales 2024', 'Auditoría de Cuentas Anuales'),
  ((SELECT id FROM crm_clients WHERE name='ASPEM TEC, S.L. - ANCA INVEST' LIMIT 1), 'FAC-2025-007', '2025-04-15', 4378.80, 0, 4378.80, 'pagada', 'Auditoría Cuentas Anuales 2024', 'Auditoría de Cuentas Anuales'),
  ((SELECT id FROM crm_clients WHERE name='ARS PIROTECNIA, S.L.' LIMIT 1), 'FAC-2025-008', '2025-04-15', 7294, 0, 7294, 'pagada', 'Auditoría Cuentas Anuales 2024', 'Auditoría de Cuentas Anuales'),
  ((SELECT id FROM crm_clients WHERE name='AKILES TECNOLOGIES' LIMIT 1), 'FAC-2025-009', '2025-03-15', 3126, 0, 3126, 'pagada', 'Auditoría Cuentas Anuales 2024', 'Auditoría de Cuentas Anuales'),
  ((SELECT id FROM crm_clients WHERE name='AUMAR TRANS, S.L.' LIMIT 1), 'FAC-2025-010', '2025-04-15', 8208.45, 0, 8208.45, 'pagada', 'Auditoría Cuentas Anuales 2024', 'Auditoría de Cuentas Anuales'),
  ((SELECT id FROM crm_clients WHERE name='BARCELONA TECHNICAL CONSOLIDAT' LIMIT 1), 'FAC-2025-011', '2025-05-15', 25310, 0, 25310, 'pagada', 'Auditoría Consolidada 2024', 'Auditoría de Cuentas Anuales'),
  ((SELECT id FROM crm_clients WHERE name='BARNAGLASS' LIMIT 1), 'FAC-2025-012', '2025-04-15', 9032.75, 0, 9032.75, 'pagada', 'Auditoría Cuentas Anuales 2024', 'Auditoría de Cuentas Anuales'),
  ((SELECT id FROM crm_clients WHERE name='BIGAS GRUP' LIMIT 1), 'FAC-2025-013', '2025-05-15', 13176.60, 0, 13176.60, 'pagada', 'Auditoría Cuentas Anuales 2024', 'Auditoría de Cuentas Anuales'),
  ((SELECT id FROM crm_clients WHERE name='BIGAS GRUP HELICOPTERS' LIMIT 1), 'FAC-2025-014', '2025-05-15', 16962, 0, 16962, 'pagada', 'Auditoría Cuentas Anuales 2024', 'Auditoría de Cuentas Anuales'),
  ((SELECT id FROM crm_clients WHERE name='BONET ESP. HIDROQUÍMIQUES' LIMIT 1), 'FAC-2025-015', '2025-04-15', 8798.12, 0, 8798.12, 'pagada', 'Auditoría Cuentas Anuales 2024', 'Auditoría de Cuentas Anuales'),
  ((SELECT id FROM crm_clients WHERE name='CASA NUALART' LIMIT 1), 'FAC-2025-016', '2025-04-15', 7702.40, 0, 7702.40, 'pagada', 'Auditoría Cuentas Anuales 2024', 'Auditoría de Cuentas Anuales'),
  ((SELECT id FROM crm_clients WHERE name='CEMAV, S.L.' LIMIT 1), 'FAC-2025-017', '2025-03-15', 2975.96, 0, 2975.96, 'pagada', 'Auditoría Cuentas Anuales 2024', 'Auditoría de Cuentas Anuales'),
  ((SELECT id FROM crm_clients WHERE name='CNG' LIMIT 1), 'FAC-2025-018', '2025-04-15', 4420, 0, 4420, 'pagada', 'Auditoría Cuentas Anuales 2024', 'Auditoría de Cuentas Anuales'),
  ((SELECT id FROM crm_clients WHERE name='COCEDERO DE MARISCOS' LIMIT 1), 'FAC-2025-020', '2025-05-15', 16253.05, 0, 16253.05, 'pagada', 'Auditoría Cuentas Anuales 2024', 'Auditoría de Cuentas Anuales'),
  ((SELECT id FROM crm_clients WHERE name='CONSOLIDAT TASMANIA' LIMIT 1), 'FAC-2025-021', '2025-05-15', 6000, 0, 6000, 'pagada', 'Auditoría Consolidada 2024', 'Auditoría de Cuentas Anuales'),
  ((SELECT id FROM crm_clients WHERE name='COSMEPRINT' LIMIT 1), 'FAC-2025-022', '2025-04-15', 9252, 0, 9252, 'pagada', 'Auditoría Cuentas Anuales 2024', 'Auditoría de Cuentas Anuales'),
  ((SELECT id FROM crm_clients WHERE name='COMPRUM' LIMIT 1), 'FAC-2025-023', '2025-04-15', 4949.50, 0, 4949.50, 'pagada', 'Auditoría Cuentas Anuales 2024', 'Auditoría de Cuentas Anuales'),
  ((SELECT id FROM crm_clients WHERE name='CUINA SOLUCIO' LIMIT 1), 'FAC-2025-024', '2025-04-15', 6404.18, 0, 6404.18, 'pagada', 'Auditoría Cuentas Anuales 2024', 'Auditoría de Cuentas Anuales'),
  ((SELECT id FROM crm_clients WHERE name='DRACENA HOMES' LIMIT 1), 'FAC-2025-025', '2025-03-15', 2084, 0, 2084, 'pagada', 'Auditoría Cuentas Anuales 2024', 'Auditoría de Cuentas Anuales'),
  ((SELECT id FROM crm_clients WHERE name='FEIMAT' LIMIT 1), 'FAC-2025-026', '2025-04-15', 8250, 0, 8250, 'pagada', 'Auditoría Cuentas Anuales 2024', 'Auditoría de Cuentas Anuales'),
  ((SELECT id FROM crm_clients WHERE name='DIESEL CERTIFICACION' LIMIT 1), 'FAC-2025-027', '2025-03-15', 1500, 0, 1500, 'pagada', 'Certificación 2024', 'Compliance'),
  ((SELECT id FROM crm_clients WHERE name='ENUR COURRIER, S.L.' LIMIT 1), 'FAC-2025-028', '2025-05-15', 12750, 0, 12750, 'pagada', 'Auditoría Cuentas Anuales 2024', 'Auditoría de Cuentas Anuales'),
  ((SELECT id FROM crm_clients WHERE name='EQUIPOS INBEAT - IND. BETA ATON' LIMIT 1), 'FAC-2025-029', '2025-04-15', 6567.89, 0, 6567.89, 'pagada', 'Auditoría Cuentas Anuales 2024', 'Auditoría de Cuentas Anuales'),
  ((SELECT id FROM crm_clients WHERE name='EXCAVACIONS I TRANSPORTS SEGU' LIMIT 1), 'FAC-2025-030', '2025-04-15', 8338, 0, 8338, 'pagada', 'Auditoría Cuentas Anuales 2024', 'Auditoría de Cuentas Anuales'),
  ((SELECT id FROM crm_clients WHERE name='EXARISER, S.L.' LIMIT 1), 'FAC-2025-031', '2025-04-15', 5747.27, 0, 5747.27, 'pagada', 'Auditoría Cuentas Anuales 2024', 'Auditoría de Cuentas Anuales'),
  ((SELECT id FROM crm_clients WHERE name='FECOSAUTO' LIMIT 1), 'FAC-2025-032', '2025-04-15', 7723.60, 0, 7723.60, 'pagada', 'Auditoría Cuentas Anuales 2024', 'Auditoría de Cuentas Anuales'),
  ((SELECT id FROM crm_clients WHERE name='FERG, S.L.' LIMIT 1), 'FAC-2025-033', '2025-03-15', 4112, 0, 4112, 'pagada', 'Auditoría Cuentas Anuales 2024', 'Auditoría de Cuentas Anuales'),
  ((SELECT id FROM crm_clients WHERE name='FERROS CRISTOBAL, S.A.' LIMIT 1), 'FAC-2025-034', '2025-04-15', 5913.03, 0, 5913.03, 'pagada', 'Auditoría Cuentas Anuales 2024', 'Auditoría de Cuentas Anuales'),
  ((SELECT id FROM crm_clients WHERE name='FORMIGONS TENES, S.L.' LIMIT 1), 'FAC-2025-035', '2025-04-15', 8538.86, 0, 8538.86, 'pagada', 'Auditoría Cuentas Anuales 2024', 'Auditoría de Cuentas Anuales'),
  ((SELECT id FROM crm_clients WHERE name='FREMATICA ESPAÑA, S.A.' LIMIT 1), 'FAC-2025-036', '2025-03-15', 3897.19, 0, 3897.19, 'pagada', 'Auditoría Cuentas Anuales 2024', 'Auditoría de Cuentas Anuales'),
  ((SELECT id FROM crm_clients WHERE name='FROM EMBALATGES' LIMIT 1), 'FAC-2025-037', '2025-05-15', 12938, 0, 12938, 'pagada', 'Auditoría Cuentas Anuales 2024', 'Auditoría de Cuentas Anuales'),
  ((SELECT id FROM crm_clients WHERE name='FUNDACIO JUBANTEY - EINA - ASTEROIDE' LIMIT 1), 'FAC-2025-038', '2025-04-15', 7736.40, 0, 7736.40, 'pagada', 'Auditoría Cuentas Anuales 2024', 'Auditoría de Cuentas Anuales'),
  ((SELECT id FROM crm_clients WHERE name='FUNDACIO GIRONA' LIMIT 1), 'FAC-2025-039', '2025-04-15', 5000, 0, 5000, 'pagada', 'Auditoría Cuentas Anuales 2024', 'Auditoría de Cuentas Anuales'),
  ((SELECT id FROM crm_clients WHERE name='GANADERIA LES VALLS' LIMIT 1), 'FAC-2025-040', '2025-04-15', 7444.30, 0, 7444.30, 'pagada', 'Auditoría Cuentas Anuales 2024', 'Auditoría de Cuentas Anuales'),
  ((SELECT id FROM crm_clients WHERE name='GARRIGA OBRES I SERVEIS' LIMIT 1), 'FAC-2025-041', '2025-04-15', 8456.56, 0, 8456.56, 'pagada', 'Auditoría Cuentas Anuales 2024', 'Auditoría de Cuentas Anuales'),
  ((SELECT id FROM crm_clients WHERE name='GAYNER, S.A.' LIMIT 1), 'FAC-2025-042', '2025-04-15', 7103.08, 0, 7103.08, 'pagada', 'Auditoría Cuentas Anuales 2024', 'Auditoría de Cuentas Anuales'),
  ((SELECT id FROM crm_clients WHERE name='GECOM ESPACIOS COMUNICACIÓN, S.L.' LIMIT 1), 'FAC-2025-043', '2025-05-15', 11462, 0, 11462, 'pagada', 'Auditoría Cuentas Anuales 2024', 'Auditoría de Cuentas Anuales'),
  ((SELECT id FROM crm_clients WHERE name='GESAB' LIMIT 1), 'FAC-2025-044', '2025-04-15', 9515.07, 0, 9515.07, 'pagada', 'Auditoría Cuentas Anuales 2024', 'Auditoría de Cuentas Anuales'),
  ((SELECT id FROM crm_clients WHERE name='GES TORELLO' LIMIT 1), 'FAC-2025-045', '2025-04-15', 5878.88, 0, 5878.88, 'pagada', 'Auditoría Cuentas Anuales 2024', 'Auditoría de Cuentas Anuales'),
  ((SELECT id FROM crm_clients WHERE name='GERMANS HOM, S.L.' LIMIT 1), 'FAC-2025-046', '2025-04-15', 5891.50, 0, 5891.50, 'pagada', 'Auditoría Cuentas Anuales 2024', 'Auditoría de Cuentas Anuales'),
  ((SELECT id FROM crm_clients WHERE name='GRUP FONTCUBERTA' LIMIT 1), 'FAC-2025-047', '2025-03-15', 3748.82, 0, 3748.82, 'pagada', 'Auditoría Cuentas Anuales 2024', 'Auditoría de Cuentas Anuales'),
  ((SELECT id FROM crm_clients WHERE name='GRUPOPTIMA' LIMIT 1), 'FAC-2025-048', '2025-04-15', 8289.77, 0, 8289.77, 'pagada', 'Auditoría Cuentas Anuales 2024', 'Auditoría de Cuentas Anuales'),
  ((SELECT id FROM crm_clients WHERE name='DES. EMP. TASMANIA' LIMIT 1), 'FAC-2025-049', '2025-05-15', 12000, 0, 12000, 'pagada', 'Auditoría Cuentas Anuales 2024', 'Auditoría de Cuentas Anuales'),
  ((SELECT id FROM crm_clients WHERE name='GRUPO T2 BUROS - EJASA' LIMIT 1), 'FAC-2025-050', '2025-04-15', 4500, 0, 4500, 'pagada', 'Auditoría Cuentas Anuales 2024', 'Auditoría de Cuentas Anuales'),
  ((SELECT id FROM crm_clients WHERE name='IBERLEMO, S.A.U' LIMIT 1), 'FAC-2025-051', '2025-03-15', 3004.75, 0, 3004.75, 'pagada', 'Auditoría Cuentas Anuales 2024', 'Auditoría de Cuentas Anuales'),
  ((SELECT id FROM crm_clients WHERE name='IBERPUERTAS' LIMIT 1), 'FAC-2025-052', '2025-04-15', 7000, 0, 7000, 'pagada', 'Auditoría Cuentas Anuales 2024', 'Auditoría de Cuentas Anuales');
